// Generated by CoffeeScript 2.7.0
define(['./SlidesFactory'], function(SlideFactory) {
  var SlidesCollView;
  SlidesCollView = (function() {
    class SlidesCollView extends Marionette.CollectionView {
      ['initialize']() {
        return this.listenTo(this, 'childview:respondeu', function(itemView, data) {
          App.main.currentvi;
          return this.showTillNext(itemView, data);
        });
      }

      ['onRender']() {
        this.children.each(function(view) {
          var imgs;
          imgs = view.$el.find('img');
          imgs.css('width', '100%');
          return imgs.each(function(k, v) {
            var src;
            src = $(v).attr('src');
            return $(v).attr('src', `${window.defaultStaticFileService}${src[0] !== '/' ? '/' : ''}${src}`);
          });
        });
        // table = view.$el.find('table')
        // table.prop('border','0')
        // table.addClass('table table-striped')
        this.questoes = this.children.filter(function(view) {
          return view.model.get('tipo').match(/questao.*/ig);
        });
        this.questoes.forEach(function(q, i) {
          q.$el.prop({
            id: 'questao_' + i
          });
          return q.$el.attr('data-seqid', i);
        });
        this.questoes[this.questaoDaVez].$el.nextAll('section').hide();
        return this.questoes[this.questaoDaVez].$el.addClass('daVez');
      }

      ['showTillNext'](view) {
        var el, j, len, nextQuest, qView, ref;
        el = view.$el;
        nextQuest = el.nextAll('section.slide[class*="quest"]')[0];
        ref = this.questoes;
        for (j = 0, len = ref.length; j < len; j++) {
          qView = ref[j];
          qView.$el.removeClass('daVez');
        }
        if (nextQuest) {
          $(nextQuest).prevAll('section').show();
          return $(nextQuest).addClass('daVez').show();
        } else {
          return this.children.each(function(view) {
            return view.$el.show();
          });
        }
      }

    };

    SlidesCollView.prototype['tagName'] = 'div';

    SlidesCollView.prototype['class'] = 'listaSlides';

    SlidesCollView.prototype['childView'] = Backbone.View;

    SlidesCollView.prototype['buildChildView'] = SlideFactory;

    SlidesCollView.prototype['questaoDaVez'] = 0;

    return SlidesCollView;

  }).call(this);
  return SlidesCollView;
});

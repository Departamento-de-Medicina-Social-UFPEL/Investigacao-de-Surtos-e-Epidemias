// Generated by CoffeeScript 2.7.0
var indexOf = [].indexOf;

define(['backbone.modal'], function(ModalView) {
  var Modal;
  Modal = (function() {
    class Modal extends Backbone.Modal {
      onRender() {
        var b;
        b = $('body');
        if (!b.is(':visible')) {
          return b.fadeIn();
        }
      }

      onDestroy() {
        $('body').css({
          'overflow': 'auto'
        });
        if (App.main.currentView) {
          return App.appRouter.previous();
        }
        return App.appRouter.navigate('/', {
          'trigger': true
        });
      }

    };

    Modal.prototype.submitEl = '.bbm-button';

    return Modal;

  }).call(this);
  return {
    "mostra": function(ids) {
      var collection, idArr;
      App.modals.destroyAll();
      idArr = ids.split(',');
      collection = new Backbone.Collection(App.badges.filter(function(i) {
        var ref;
        return ref = i.get('_id'), indexOf.call(idArr, ref) >= 0;
      }));
      if (App.modals.currentView) {
        App.modals.destroyAll();
      }
      return App.modals.show(new (Modal.extend({
        template: _.template($('#badge-ganhou').html()),
        onDestroy: function() {
          $('body').css({
            'overflow': 'auto'
          });
          if (App.main.currentView) {
            return;
          }
          return App.appRouter.navigate('/', {
            'trigger': true
          });
        }
      }))({collection}));
    },
    "lista": function() {
      var ListaModal;
      App.modals.destroyAll();
      App.progresso.badgesConcedidos = App.progresso.temNovosBadges(true);
      ListaModal = Modal.extend({
        template: _.template($('#badge-all').html()),
        onDestroy: function() {
          $('body').css({
            'overflow': 'auto'
          });
          if (!App.main.currentView) {
            return App.appRouter.navigate('/', {
              'trigger': true
            });
          }
          if (App.modals.currentView) {
            return App.appRouter.previous();
          }
        }
      });
      return App.modals.show(new ListaModal());
    }
  };
});

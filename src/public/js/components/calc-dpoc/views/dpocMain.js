// Generated by CoffeeScript 2.7.0
define(['backbone', 'backbone.marionette'], function(Backbone, Marionette) {
  var DpocMainView;
  DpocMainView = (function() {
    class DpocMainView extends Marionette.ItemView {
      changeDados() {
        var conduta, dados, estado, tab, template;
        dados = this.getDados();
        estado = this.calculaEscore(dados);
        tab = this.tabela;
        conduta = _(tab).find(function(item) {
          return item.estado.indexOf(estado) !== -1;
        });
        if (conduta) {
          this.ui.gravidade.text(conduta.gravidade);
          template = function(item) {
            return `<li class='list-group-item'>${item}</li>`;
          };
          this.ui.listaManejo.empty().append(conduta.manejo.map(template).join(''));
          if (!(conduta.manejo.length < 0)) {
            this.ui.manejo.show();
          }
          return this.ui.resposta.show();
        } else {
          return this.ui.resposta.hide();
        }
      }

      getDados() {
        return {
          razao: this.ui.razao.prop('checked'),
          respiratoria: this.ui.temIRC.prop('checked'),
          radio: this.ui.radios.filter(':checked').val()
        };
      }

      calculaEscore(d) {
        var gravidade;
        return gravidade = (function() {
          switch (d.radio) {
            case "1":
              return 'I';
            case "2":
              return 'II';
            case "3":
              if (d.respiratoria) {
                return 'IV';
              } else {
                return 'III';
              }
              break;
            case "4":
              return 'V';
            default:
              return '0';
          }
        })();
      }

      onRender(view) {
        this.ui.resposta.hide();
        return this.ui.manejo.hide();
      }

    };

    DpocMainView.prototype.model = new Backbone.Model();

    DpocMainView.prototype.className = 'item calculadoras dpoc';

    DpocMainView.prototype.template = "#calc-dpoc-main";

    DpocMainView.prototype.ui = {
      'razao': '#razaoVef1Cvf',
      'temIRC': '#insuficieciaRespCronica',
      'radios': 'input:radio[name="optionRadios"]',
      'gravidade': '.gravidade',
      'listaManejo': '.list-group',
      'resposta': '.condutaBox',
      'manejo': '.manejo'
    };

    DpocMainView.prototype.events = {
      'change @ui.razao, @ui.temIRC, @ui.radios': 'changeDados'
    };

    DpocMainView.prototype.tabela = [
      {
        gravidade: 'Não configura DPOC',
        estado: '0',
        manejo: ['Não requer para esta doença']
      },
      {
        gravidade: 'Leve',
        estado: 'I',
        manejo: ["Beta2-agonista de curta duração",
      "e/ou ipratrópio, quando necessário"]
      },
      {
        gravidade: 'Moderada',
        estado: 'II',
        manejo: ["Reabilitação pulmonar",
      "<b>Sintomas eventuais:</b> Beta2- agonista de curta duração e/ou ipratrópio, quando necessário",
      "<b>Sintomas persistentes:</b> Beta2-agonista de longa duração e/ou tiotrópio"]
      },
      {
        gravidade: 'Grave',
        estado: 'III',
        manejo: ["Reabilitação Pulmonar",
      "Beta2-agonista de longa duração e tiotrópio",
      "Se persistirem sintomas acrescentar xantina de longa duração",
      "Corticoide inalatório se exacerbações frequentes (>= 2 exacerbações ao ano)"]
      },
      {
        gravidade: 'Muito grave',
        estado: 'IV',
        manejo: ["Reabilitação Pulmonar",
      "Beta2-agonista de longa duração e tiotrópio",
      "Se persistirem sintomas acrescentar xantina de longa duração",
      "Corticoide inalatório se exacerbações frequentes (>= 2 exacerbações ao ano)",
      "Oxigenoterapia",
      "Estudar indicações cirúrgicas para o tratamento do enfisema (cirurgia redutora de volume pulmonar, bulectomia ou transplante pulmonar)"]
      }
    ];

    return DpocMainView;

  }).call(this);
  return DpocMainView;
});

// Generated by CoffeeScript 2.7.0
var getDadosSituacaoMonitoramento;

define(['./graficos/GraficoEmpilhadoView'], function(GraficoEmpilhadoView) {
  return function(data) {
    var RealGraficoView, modelo, tipo;
    console.log('modelo grafico', data);
    tipo = data.get('tipo');
    RealGraficoView = (function() {
      switch (tipo) {
        case 'empilhado':
          return GraficoEmpilhadoView;
        default:
          return GraficoEmpilhadoView;
      }
    })();
    modelo = (function() {
      switch (tipo) {
        case 'empilhado':
          return getDadosSituacaoMonitoramento(data);
        default:
          return getDadosSituacaoMonitoramento(data);
      }
    })();
    return new RealGraficoView({
      model: data,
      tagName: 'section',
      className: "grafico empilhado"
    });
  };
});

getDadosSituacaoMonitoramento = function(modelo) {
  var andamento, dados, encerrado, naoIniciado;
  console.log('modelo grafico dados', modelo);
  dados = modelo.get('dados');
  naoIniciado = andamento = encerrado = [];
  modelo.set('categorias', dados.map(function(d) {
    var fim;
    fim = modelo.get('tipo') !== 'dia' ? ' à ' + d.periodoFim : '';
    return d.periodoInicio + fim;
  }));
  dados.forEach(function(d) {
    naoIniciado.push(parseFloat(d.nrNaoIniciados) * 100 / d.nrMonitorados);
    andamento.push(parseFloat(d.nrEmAndamento) * 100 / d.nrMonitorados);
    return encerrado.push(parseFloat(d.nrEncerrados) * 100 / d.nrMonitorados);
  });
  modelo.set('series', [
    {
      name: "Não iniciados",
      data: naoIniciado
    },
    {
      name: "Em andamento",
      data: andamento
    },
    {
      name: "Encerrados",
      data: encerrado
    }
  ]);
  return modelo;
};

// Generated by CoffeeScript 1.8.0
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

define(['backbone.modal'], function(ModalView) {
  var Modal;
  Modal = (function(_super) {
    __extends(Modal, _super);

    function Modal() {
      return Modal.__super__.constructor.apply(this, arguments);
    }

    Modal.prototype.submitEl = '.bbm-button';

    Modal.prototype.onRender = function() {
      var b;
      b = $('body');
      if (!b.is(':visible')) {
        return b.fadeIn();
      }
    };

    Modal.prototype.onDestroy = function() {
      $('body').css({
        'overflow': 'auto'
      });
      if (App.main.currentView) {
        return App.appRouter.previous();
      }
      return App.appRouter.navigate('/', {
        'trigger': true
      });
    };

    return Modal;

  })(Backbone.Modal);
  return {
    "mostra": function(ids) {
      var collection, idArr;
      App.modals.destroyAll();
      idArr = ids.split(',');
      collection = new Backbone.Collection(App.badges.filter(function(i) {
        var _ref;
        return _ref = i.get('_id'), __indexOf.call(idArr, _ref) >= 0;
      }));
      if (App.modals.currentView) {
        App.modals.destroyAll();
      }
      return App.modals.show(new (Modal.extend({
        template: _.template($('#badge-ganhou').html()),
        onDestroy: function() {
          $('body').css({
            'overflow': 'auto'
          });
          if (App.main.currentView) {
            return;
          }
          return App.appRouter.navigate('/', {
            'trigger': true
          });
        }
      }))({
        collection: collection
      }));
    },
    "lista": function() {
      var ListaModal;
      App.modals.destroyAll();
      App.progresso.badgesConcedidos = App.progresso.temNovosBadges(true);
      ListaModal = Modal.extend({
        template: _.template($('#badge-all').html()),
        onDestroy: function() {
          $('body').css({
            'overflow': 'auto'
          });
          if (!App.main.currentView) {
            return App.appRouter.navigate('/', {
              'trigger': true
            });
          }
          if (App.modals.currentView) {
            return App.appRouter.previous();
          }
        }
      });
      return App.modals.show(new ListaModal);
    }
  };
});

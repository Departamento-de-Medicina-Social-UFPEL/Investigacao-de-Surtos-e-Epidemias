// Generated by CoffeeScript 1.8.0
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define(['./selecaoItemView', 'marionette'], function(ItemView, Marionette) {
  var MainSelecaoLayout;
  return MainSelecaoLayout = (function(_super) {
    __extends(MainSelecaoLayout, _super);

    function MainSelecaoLayout() {
      return MainSelecaoLayout.__super__.constructor.apply(this, arguments);
    }

    MainSelecaoLayout.prototype.template = '#selecao-progresso-main';

    MainSelecaoLayout.prototype.childView = ItemView;

    MainSelecaoLayout.prototype.childViewContainer = '.listaCasos';

    MainSelecaoLayout.prototype.className = 'container selecao-main';

    MainSelecaoLayout.prototype.initialize = function() {
      var nuc, nucs;
      nuc = App.progresso.user.get('profissional');
      nucs = {
        '1': 1,
        '2': 0,
        '3': 2
      };
      this.collection.comparator = function(at1, at2) {
        var isPro1, isPro2, nNucs1, nNucs2, pro1, pro2;
        pro1 = at1.get('pro');
        isPro1 = pro1[nucs[nuc]];
        nNucs1 = pro1.reduce(function(m, i) {
          if (i) {
            return m + 1;
          } else {
            return m;
          }
        });
        pro2 = at2.get('pro');
        isPro2 = at2.get('pro')[nucs[nuc]];
        nNucs2 = pro2.reduce(function(m, i) {
          if (i) {
            return m + 1;
          } else {
            return m;
          }
        });
        if (isPro1 && isPro2) {
          if (nNucs1 < nNucs2) {
            return -1;
          } else if (nNucs1 > nNucs2) {
            return 1;
          }
          return 0;
        } else if (isPro1) {
          return -1;
        } else if (isPro2) {
          return 1;
        }
        return 0;
      };
      return this.collection.sort();
    };

    return MainSelecaoLayout;

  })(Marionette.CompositeView);
});
